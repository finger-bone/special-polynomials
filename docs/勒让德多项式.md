---
sidebar_position: 3
---

# 勒让德多项式

开算。

## 勒让德方程

勒让德方程是，

$$
(1-x^2)D^2y - 2xDy - \lambda y = 0
$$

算 $k(x)$ ，

$$
\int \frac{-2x}{1-x^2} \mathrm{d}x = \log(1-x^2) + C
$$

$$
k(x) = 1-x^2
$$

$$
D((1-x^2)Dy)=\lambda y
$$

定义域是 $-1$ 到 $1$ 。

我们记勒让德多项式为为 $R_n$ ，一般书都会记成 $P_n$ ，但是这和我们之前的记号重了……

此外，注意，这里的计算是算量很大的——我提出的这个方法本征值算的很快，但是具体函数需要从生成函数绕一大圈。下一章我们会直接推出二阶二次厄米算子本征方程的通解，包括本征值，本征函数。

## 本征函数的计算

这里略过推导，因为推导和前文完全一致。总而言之，过程一致，可以得到，

$$
|n+1\rangle = x|n\rangle + B_n|n\rangle + C_n |n-1\rangle
$$

同样的，作用算子，

$$
\hat{E} = D((1-x^2)D)
$$

$$
\lambda_{n+1}|n+1\rangle = \hat{E}(x|n\rangle) + \lambda_n B_n|n\rangle +\lambda_{n-1} C_n |n-1\rangle
$$

对 $n+1$ 阶的系数的得到 $\lambda_n$ ，

$$
\lambda_{n+1} = -(n+1)(n+2)
$$

同样的定义 $P_n$ ， $Q_n$ ，

$$
P_{n+1} = P_n + B_n \\
Q_{n+1} = Q_n + B_n P_n + C_n 
$$

然后对 $n$ 阶系数得到 $B_n$ ， $P_n$ ，

$$
\lambda_{n+1} P_{n+1} = \lambda_n B_n - n(n+1)P_{n}
$$

先解出来 $B_n$，

$$
-(n+1)(n+2) P_{n+1} = -n(n+1) B_n - n(n+1)P_{n}
$$

$$
-(n+2)P_{n+1} = -nB_n - nP_n
$$

用另一个关系，

$$
P_{n+1} = P_n + B_n
$$

$$
nP_{n+1} = nP_n + nB_n
$$

两个相加，

$$
-2P_{n+1} = 0
$$

因此，

$$
P_n = 0
$$

$$
B_n = 0
$$

勒让德多项式有这两个零，因此计算方便些。这说明勒让德多项式没有次高项（事实上，勒让德多项式只有与最高次差偶数次的项）。

现在把零带回去，

$$
\lambda_{n+1}|n+1\rangle = \hat{E}(x|n\rangle) + \lambda_{n-1} C_n |n-1\rangle
$$

然后对 $n-1$ 阶，

$$
\hat{E}(x|n\rangle) = D((1-x^2)D(x R_n))
$$

$P_n$ 的最高阶给 $x^{n-1}$ 贡献 $(n+1)n-Q_n(n-1)n$ 。

因此，

$$
\lambda_{n+1} Q_{n+1} = (n+1)n-Q_n(n-1)n + \lambda_{n-1}C_n
$$

展开本征值，

$$
-(n+1)(n+2) Q_{n+1} = (n+1)n-Q_n(n-1)n - (n-1)nC_n
$$

除一个 $n$ ，

$$
-\frac{(n+1)(n+2)}{n} Q_{n+1} = (n+1)-Q_n(n-1) - (n-1)C_n
$$

又有，

$$
Q_{n+1} = Q_n + C_n 
$$

$$
(n-1)Q_{n+1} = (n-1)Q_n + (n-1)C_n 
$$

两个相加，

$$
((n-1)-\frac{(n+1)(n+2)}{n}) Q_{n+1} = (n+1)
$$

$$
(\frac{(n-1)n}{n}-\frac{(n+1)(n+2)}{n}) Q_{n+1} = (n+1)
$$

$$
(\frac{(n+1)(n+2) - (n-1)n}{n}) Q_{n+1} = -(n+1)
$$

$$
(\frac{n^2+3n+2 - n^2 + n}{n}) Q_{n+1} = -(n+1)
$$

$$
(\frac{4n+2}{n}) Q_{n+1} = -(n+1)
$$

$$
(\frac{4n-2}{n-1}) Q_{n} = -n
$$

$$
Q_{n} = -n (\frac{n-1}{4n-2}) \\
= -n \frac{2n-2}{4(2n-1)} \\
= -\frac{n}{4}(1 - \frac{1}{2n-1})
$$

$$
-C_n = Q_{n} - Q_{n+1} \\
= \frac{n+1}{4}(1 - \frac{1}{2n+1}) - \frac{n}{4}(1 - \frac{1}{2n-1}) \\
= \frac{1}{4}(1 + \frac{n}{2n-1} - \frac{n+1}{2n+1}) \\
= \frac{1}{4}(1 + \frac{2n^2 + n - (2n-1)(n+1)}{(2n-1)(2n+1)}) \\
= \frac{1}{4}(\frac{2n^2 + n + (2n-1)n}{(2n-1)(2n+1)}) \\
= \frac{n^2}{(2n-1)(2n+1)}
$$

综上，

$$
|n+1\rangle = x|n\rangle - \frac{n^2}{(2n-1)(2n+1)} |n-1\rangle
$$

前两项为，

$$
|0\rangle = 1 \\
|1\rangle = x
$$

算一下模长，

$$
0 = \langle n - 1|x|n\rangle - \frac{n^2}{(2n-1)(2n+1)} \langle n - 1 |n-1\rangle
$$

再一次，因为 $\langle n - 1|$ 首一， $\langle n - 1|x$ 也是首一。 $\langle n - 1|x$ 可以被 $\langle i|,i\leq n$ 展开，且 $\langle n|$ 项系数为 $1$ 。又由正交性，只有这一项贡献模长，因此，

$$
\langle n - 1|x|n\rangle = \langle n |n\rangle
$$

即，

$$
\langle n |n\rangle = \frac{n^2}{(2n-1)(2n+1)} \langle n - 1 |n-1\rangle
$$

$$
\langle 0 | 0\rangle=2
$$

可以写出通项，

$$
\langle n |n\rangle = 2 \prod_{k=1}^{n} \frac{k^2}{(2k-1)(2k+1)} \\
= 2 \frac{(n!)^2}{(2n-1)!!(2n+1)!!}
= 2 \frac{(n!)^2}{((2n-1)!!)^2(2n+1)}
$$

双阶乘可以化为单阶乘，

$$
\langle n |n\rangle = 2 \prod_{k=1}^{n} \frac{k^2}{(2k-1)(2k+1)} \\
= 2 \frac{(n!)^2((2n)!!)^2}{((2n-1)!!(2n)!!)^2(2n+1)} \\
= 2\frac{2^{2n} (n!)^4}{((2n)!)^2(2n+1)} \\
= \frac{2^{2n + 1} (n!)^4}{((2n)!)^2(2n+1)}
$$

这个长度有点复杂，开根也不有理。一般来说课本上的也不是归一，而是使得每个的模长为，

$$
\sqrt{\frac{2}{2n+1}}
$$

因为剩下的部分可以有理地开根，

$$
\langle n |n\rangle 
= \frac{2}{n+1} (\frac{2^n (n!)^2}{(2n)!})^2
$$

这种规定也可以视为保证 $R_n(1) = 1$ ，因为我们有，

$$
R_{n+1} = xR_n - \frac{n^2}{(2n-1)(2n+1)}R_{n-1}
$$

我们算一下首一下 $1$ 处值的递推，

$$
R_{n+1}(1) = R_n(1) - \frac{n^2}{(2n-1)(2n+1)}R_{n-1}(1)
$$

$$
\frac{R_{n+1}(1)}{R_n(1)} = 1 - \frac{n^2}{(2n-1)(2n+1)}\frac{R_{n-1}(1)}{R_n(1)}
$$

$$
\frac{R_{n+1}(1)}{R_n(1)}\frac{2n+1}{n+1} = \frac{2n+1}{n+1} - \frac{n}{n+1}\frac{R_{n-1}(1)}{R_n(1)}\frac{n}{2n-1}
$$

记，

$$
K_n = \frac{R_{n-1}(1)}{R_n(1)}\frac{n}{2n-1}
$$

则，

$$
K_{n+1} = \frac{R_{n}(1)}{R_{n+1}(1)}\frac{n+1}{2n + 1}
$$

因此，

$$
\frac{1}{K_{n+1}}=\frac{2n+1}{n+1} - \frac{n}{n+1}K_n
$$

不动点是 $1$ ，但是显然 $K_0=1$ ，因此，

$$
1 = \frac{R_{n-1}(1)}{R_n(1)}\frac{n}{2n-1}
$$

整理过程和上面求模长一样，最后得到，

$$
R_n(1) = \frac{2^n (n!)^2}{(2n)!}
$$

因此可以用，

$$
\frac{2^n (n!)^2}{(2n)!}
$$

做因子标准化。这个因子和前面一样。

## 生成函数

Rodrigues 公式这里我想不出啥好方法来，参考大部分教科书吧……鉴于后面我们会直接给出一个很方便的公式，这里证明它也没啥意义，就不算了。

下面 $D$ 是对 $z$ 求导。

$$
|n+1\rangle = x|n\rangle - \frac{n^2}{(2n-1)(2n+1)} |n-1\rangle
$$

理论上可以直接算，但其实我们在前面拉盖尔函数生成函数求解时节省了一部分——就是为什么取，

$$
G(z;x)=\sum_{n=0}^{\infty}\frac{1}{n!}L_nz^n
$$

即为什么除一个阶乘——如果你不加这个，会特别难算——其实是完全没法算（其实可以解，但是首先计算麻烦，其次最后需要分解一个带微分的算子，没有软件辅助很难算，但确实可以得到结果）。

下面的勒让德函数的计算也是。如果你直接按这个带阶乘的展开，一算一个不吱声。如果不加，依然很难算。我们需要在这里给出确定这个加权的方法。

现在我们不求 $R_n$ ，而是求一个加权的 $S_nR_n$ ，即，

$$
G(z;x)=\sum_{n=0}^{\infty}S_nR_nz^n
$$

我们规定 $G(z;x)$ 必须满足一阶微分方程，阶数不能再高了，不然没法解。

$$
DG(z;x)=\sum_{n=0}^{\infty}nS_nR_nz^{n-1}
$$

而且我们希望不存在分母——分母意味着积分。

前面这里，

$$
R_{n+1}= xR_n - \frac{n^2}{(2n-1)(2n+1)}R_{n-1e}
$$

$$
S_nR_{n+1}z^n= xS_nR_nz^n - S_n\frac{n^2}{(2n-1)(2n+1)}R_{n-1}z^n
$$

我们需要让所有项的系数都是一次——否则会需要二阶导数。

我们设，

$$
K_{n+1}=\frac{S_{n}}{S_{n+1}}
$$

那么有，

$$
K_{n+1}S_{n+1}R_{n+1}z^n= xS_nR_nz^n - \frac{S_{n-1}}{K_n}\frac{n^2}{(2n-1)(2n+1)}R_{n-1}z^n
$$

$$
K_{n+1}(S_{n+1}R_{n+1}z^n)= x(S_nR_nz^n) - \frac{1}{K_n}\frac{n^2}{(2n-1)(2n+1)}(S_{n-1}R_{n-1}z^n)
$$

现在只这么做显然无法保证至高一次性。我们待定一个因子 $P$ ，

$$
PK_{n+1}(S_{n+1}R_{n+1}z^n)= xP(S_nR_nz^n) - \frac{P}{K_n}\frac{n^2}{(2n-1)(2n+1)}(S_{n-1}R_{n-1}z^n)
$$

把分母乘过去，

$$
(2n-1)(2n+1)PK_{n+1}(S_{n+1}R_{n+1}z^n)= x(2n-1)(2n+1)P(S_nR_nz^n) - \frac{P}{K_n}n^2(S_{n-1}R_{n-1}z^n)
$$

现在因子不多，其实可以猜。但是最好是可以分析出来 $P$ 和 $K_n$ 。

$$
(2n-1)(2n+1)P
$$

说明 $P$ 有且只能有分母因式 $(2n-1)$ 或 $(2n+1)$ 。

$$
\frac{P}{K_n} n^2
$$

说明 $K_n$ 的分母因式必须和 $P$ 分母因式相同，否则这一项会留下分母。

如果 $P$ 和 $K_n$ 的分母有 $2n+1$ ，那么 $K_{n+1}$ 的分母有 $2n+3$ ，但是这会导致，

$$
(2n-1)(2n+1)PK_{n+1}
$$

留下分母。因此 $K_{n}$ 有分母因式 $2n-1$ ， $P$ 有且仅有分母因式 $2n-1$ 。

但是，

$$
\frac{P}{K_n} n^2
$$

至多只能留下一阶，但是 $P$ 有且只能有分母因式 $(2n-1)$ ，说明 $K_n$ 有分子因式 $n^c, c\geq1$ 。

但是，

$$
(2n-1)(2n+1)PK_{n+1}
$$

的结果一定是 $PK_{n+1}$ 的分子因式的积（因为 $PK_{n+1}$ 有分母因式 $(2n-1)(2n+1)$ ）。

因此 $c = 1$ ，同时说明 $P$ 分子因式是零阶。综上，

$$
P = \frac{1}{2n-1}
$$

$$
K_n = \frac{n}{2n-1}
$$

因此可以算出来，

$$
S_n = \frac{2^n (n!)^2}{(2n)!}
$$

这个计算上面已经算过了。

注意，

$$
S_0 = 1 \\
S_1 = 1
$$

此时递推是，

$$
(n+1)(S_{n+1}R_{n+1}z^n)= x(2n+1)(S_nR_nz^n) - n(S_{n-1}R_{n-1}z^n)
$$

这样就好算多了。

累和，

$$
\sum_{n=1}^\infty(n+1)(S_{n+1}R_{n+1}z^n)= \sum_{n=1}^\infty x(2n+1)(S_nR_nz^n) - \sum_{n=1}^\infty n(S_{n-1}R_{n-1}z^n)
$$

左边，

$$
G(z;x)=\sum_{n=0}^{\infty}S_nR_nz^n
$$

$$
G(z;x)-1=\sum_{n=1}^{\infty}S_nR_nz^n
$$

$$
G(z;x)-1=\sum_{n=0}^{\infty}S_{n+1}R_{n+1}z^{n+1}
$$

$$
D(G(z;x)-1) = DG(z;x) =\sum_{n=0}^{\infty}(n+1)S_{n+1}R_{n+1}z^{n}
$$

$$
DG(z;x) -x =\sum_{n=1}^{\infty}(n+1)S_{n+1}R_{n+1}z^{n}
$$

右边，

$$
G(z;x)-1=\sum_{n=1}^{\infty}S_nR_nz^n
$$

$$
D(G(z;x)-1) = DG(z;x) =\sum_{n=1}^{\infty}nS_nR_nz^{n-1}
$$

$$
zDG(z;x) = \sum_{n=1}^{\infty}nS_nR_nz^{n}
$$

$$
G(z;x)=\sum_{n=0}^{\infty}S_nR_nz^n
$$

$$
G(z;x)=\sum_{n=1}^{\infty}S_{n-1}R_{n-1}z^{n-1}
$$

$$
zG(z;x)=\sum_{n=1}^{\infty}S_{n-1}R_{n-1}z^{n}
$$

$$
D(zG(z;x)) =\sum_{n=1}^{\infty}nS_{n-1}R_{n-1}z^{n-1}
$$

$$
zD(zG(z;x)) =\sum_{n=1}^{\infty}nS_{n-1}R_{n-1}z^{n}
$$

最后有，

$$
DG(z;x) -x = 2xzDG(z;x) + x(G(z;x)-1) - zD(zG(z;x))
$$

整理一下，

$$
DG(z;x) -x = 2xzDG(z;x) + xG(z;x) - x - zG(z;x) - z^2DG(z;x)
$$

$$
DG(z;x) = 2xzDG(z;x) + xG(z;x) - zG(z;x) - z^2DG(z;x)
$$

$$
(z^2-2xz+1)DG(z;x) + (z-x)G(z;x) = 0
$$

求积分因子，

$$
\int\frac{z-x}{z^2-2xz+1} \mathrm{d}z \\
= \frac{1}{2} \int \frac{1}{z^2-2xz+1} \mathrm{d}(z^2-2xz+1) \\
= \frac{1}{2} \log (z^2-2xz+1) + ?
$$

积分因子是，

$$
e^{\frac{1}{2} \log (z^2-2xz+1)} = \sqrt{z^2-2xz+1}
$$

因此，

$$
G(z;x)\sqrt{z^2-2xz+1} = C
$$

又，

$$
G(0;x) = S_0R_0 = 1
$$

因此，

$$
G(z;x) = \frac{1}{\sqrt{z^2-2xz+1}}
$$

这个生成函数 $z$ 的 $n$ 次方系数为，

$$
S_nR_n(x)
$$

本征函数缩放不影响本征性，因此也可以直接把带权的作为本征函数集。

这里就算到生成函数吧，从生成函数的系数展开式肯定是能得到 Rodrigues 公式的，只是算量和技巧的问题。

下一章我们开始考虑任意情况。