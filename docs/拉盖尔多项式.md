---
sidebar_position: 2
---

# 拉盖尔多项式

先算拉盖尔作为演示。

## 拉盖尔方程

拉盖尔方程的一般形式是，

$$
xD^2y+(1-x)Dy - \lambda y=0
$$

化为厄米的形式，当然，可以看到这个方程天生是不满足厄米条件的，两边乘一个 $w(x)$ 后是可以的。

事实上，有通用的方法——我们记，

$$
k(x) = pw
$$

因此，

$$
kD^2y+k'Dy+? = 0
$$

即，

$$
\frac{k'}{k} = \frac{1-x}{x}
$$

这是个经典的一阶微分方程，

$$
\int \frac{1-x}{x} \mathrm{d}x \\
= \log (x) - x + ?
$$

因此，

$$
k(x) = e^{-x}x
$$

因此，

$$
w(x) = e^{-x}
$$

$$
xe^{-x} D^2y + (1-x)e^{-x} D y = \lambda e^{-x} y
$$

是厄米的。

记左侧为算子（稍微化简一点），

$$
\hat{E} = D(e^{-x}x D)
$$

下面为了方便，记，

$$
L_n = |n\rangle
$$

## 本征函数的计算

下面我们保证 $L_n$ 是首一的（即最高次项系数为 $1$）。（根据不同的书，这里的规定不同。有些规定 $L_n$ 是归一的，即 $\langle n|n \rangle = 1$。此时只差一个常系数）。

因为 $L_n(x)$ 相互正交，且是按次数递增的，因此前 $n$ 个 $L_n(x)$ 必然能张成次数低于 $n$ 的多项式空间。因此，

$$
x|n\rangle = \sum_{k=0}^{n+1} ?_k |k\rangle
$$

式子左边整体是一个任意给的多项式，因此它一定可以被拉盖尔函数集张成。

可以为了方便换一下顺序，

$$
|n+1\rangle = A_n x|n\rangle + \sum_{k=0}^{n} c_k |k\rangle
$$

我们两侧作用 $\langle m|$ ， $m \leq n$ 。

$$
\langle m|n+1\rangle = 0 = A_n \langle m|x|n\rangle + c_m \langle m|m\rangle
$$

注意，狄拉克记号里的算子都必须是厄米的。而这里只涉及实函数，而在定义下实函数一定是厄米的，即这里的 $x$。

考察，

$$
\langle m|x|n\rangle
$$

如果将 $\langle m|x$ 视为整体，那么这个操作是计算 $\langle m|x$ 在 $|n\rangle$ 上的投影。因为 $\langle m|x$ 也是多项式，必然也能展开，

$$
x | m \rangle = \sum_{k=0}^{m+1} ?_k |k\rangle
$$

最高次是 $m+1$ 阶，因此当 $m+1 < n$ 时，这个投影为零（正交性）。

而如果 $\langle m|x|n\rangle$ 为零， $c_m$ 也为零。因此，对于，

$$
|n+1\rangle = A_n x|n\rangle + \sum_{k=0}^{n} c_k |k\rangle
$$

只有 $k = n - 1$ 与 $k = n$ ， $c_k$ 可能不为零，因此，

$$
|n+1\rangle = A_n x|n\rangle + B_n |n\rangle + C_n |n - 1\rangle
$$

如果我们要保证首一性，因为右侧最高次项只能来自 $x|n\rangle$，如果 $|n\rangle$ 首一，要保证 $|n+1\rangle$ 首一， $A_n = 1$。综上，我们得到带有待定系数的递推公式，

$$
|n+1\rangle = x|n\rangle + B_n |n\rangle + C_n |n - 1\rangle
$$

一旦确定待定系数。我们就能得到拉盖尔函数。

两侧作用算子 $\hat{E}$ ，

$$
\lambda_{n+1} |n+1\rangle = e^{x} \hat{E}(x|n\rangle) + \lambda_n B_n |n\rangle + \lambda_{n-1} C_n |n - 1\rangle
$$

由基底展开的唯一性， $e^{x} \hat{E}(x|n\rangle)$ 必然会产出与 $\lambda_n B_n |n\rangle + \lambda_{n-1} C_n |n - 1\rangle$ 相抵消的项，然后产出 $\lambda_{n+1} |n+1\rangle$ 。

现在继续展开，

$$
\lambda_{n+1} |n+1\rangle = \\
e^{x} \hat{E}(x|n\rangle) + \lambda_n B_n |n\rangle + \lambda_{n-1} C_n |n - 1\rangle \\
= e^{x} D(e^{-x} x D (x L_n))  + \lambda_n B_n |n\rangle + \lambda_{n-1} C_n |n - 1\rangle \\
= -xD(xL_n) + D(xL_n) + xD^2(x L_n)  + \lambda_n B_n |n\rangle + \lambda_{n-1} C_n |n - 1\rangle
$$

考虑 $n+1$ 次项，左侧的系数为 $\lambda_{n+1}$ （首一性），右侧的最高次只能来自 $-xD(xL_n)$ 。它产生且只产生 $n+1$ 次项，

$$
-xD(xL_n) \\
= -x^2 D L_n -x L_n
$$

再次，因为首一性， $-x^2 D L_n$ 产生一个系数为 $n$ 的 $n+1$ 次项， $x L_n$ 产生一个系数为 $1$ 的 $n+1$ 次项。两侧系数相同，因此，

$$
\lambda_{n+1} = -(n + 1)
$$

即对于任意的 $n$ ， $\lambda_n = -n$ 。

现在考虑 $n$ 次项。设 $|n\rangle$ 的次高项系数为 $P_n$，先考虑，

$$
|n+1\rangle = x|n\rangle + B_n |n\rangle + C_n |n - 1\rangle
$$

根据首一性，

$$
P_{n+1} = P_n + B_n
$$

继续考虑，

$$
\lambda_{n+1} |n+1\rangle = -xD(xL_n) + D(xL_n) + xD^2(x L_n)  + \lambda_n B_n |n\rangle + \lambda_{n-1} C_n |n - 1\rangle
$$

左侧的 $n$ 次项系数为 $\lambda_{n+1} P_{n+1}$。继续考虑右侧。

现在考察右侧能产生的 $n$ 次项。

首先是 $\lambda_n B_n |n\rangle$，因为首一性产生一个 $\lambda_n B_n$ 。

然后是， $-xD(xL_n)$ 求导里面 $L_n$ 的 $n - 1$ 次项系数为 $P_n$ ，因此这一项产生 $- n P_n $ 。

$D(xL_n)$ 因为首一性产生 $n + 1$ 。

$xD^2(x L_n)$ 因为首一性贡献 $n (n + 1)$ 。

因此，

$$
\lambda_{n+1} P_{n+1} = \lambda_n B_n - nP_n + (n + 1) ^ 2
$$

这里其实可以直接解出来 $B_n$ 。但我们稍后同 $C_n$ 一起解。

考虑 $n-1$ 次项。

同样的，设 $|n\rangle$ 第二次高项系数为 $Q_n$ ，因为，

$$
|n+1\rangle = x|n\rangle + B_n |n\rangle + C_n |n - 1\rangle
$$

因此，

$$
Q_{n+1} = Q_n + B_n P_n + C_n
$$

再看，

$$
\lambda_{n+1} |n+1\rangle = -xD(xL_n) + D(xL_n) + xD^2(x L_n)  + \lambda_n B_n |n\rangle + \lambda_{n-1} C_n |n - 1\rangle
$$

可以稍微化简一点点，

$$
\lambda_{n+1} |n+1\rangle = -xD(xL_n) + D(xD(xL_n)) + \lambda_n B_n |n\rangle + \lambda_{n-1} C_n |n - 1\rangle
$$

左侧的 $n-1$ 次项系数为 $\lambda_{n+1} Q_{n+1}$。

右侧逐项考虑，全都有贡献。

$-xD(xL_n)$ 贡献 $-(n-1)Q_n$ 。 $D(xD(xL_n))$ 贡献 $n^2P_n$ ，$\lambda_n B_n |n\rangle$ 贡献 $\lambda_n B_n P_n$ ， $\lambda_{n-1} C_n |n - 1\rangle$ 贡献 $\lambda_{n-1} C_n$ 。

因此，

$$
\lambda_{n+1} Q_{n+1} = \lambda_{n-1} C_n + \lambda_n B_n P_n + n^2 P_n - (n - 1) Q_n
$$

综上，我们有以下的方程，

$$
\begin{cases}
\lambda_n = -n \\
P_{n+1} = P_n + B_n \\
\lambda_{n+1} P_{n+1} = \lambda_n B_n - nP_n + (n + 1) ^ 2 \\
Q_{n+1} = Q_n + B_n P_n + C_n \\
\lambda_{n+1} Q_{n+1} = \lambda_{n-1} C_n + \lambda_n B_n P_n + n^2 P_n - (n - 1) Q_n \\
\end{cases}
$$

把 $\lambda_n$ 带入，

$$
\begin{cases}
P_{n+1} = P_n + B_n \\
-(n+1) P_{n+1} = -n B_n - nP_n + (n + 1) ^ 2 \\
Q_{n+1} = Q_n + B_n P_n + C_n \\
-(n+1) Q_{n+1} = -(n-1) C_n - n B_n P_n + n^2 P_n - (n - 1) Q_n \\
\end{cases}
$$

先用前两条解 $B_n$ 和 $P_n$ 。

$$
P_{n+1} = P_n + B_n
$$

两侧乘 $n$。

$$
nP_{n+1} - nP_n = B_n
$$

加上第二条，

$$
-P_{n+1} = (n+1)^2
$$

即，

$$
P_n = -n^2
$$

$$
B_n = P_{n+1} - P_{n} = -(2n+1)
$$

现在把这两个带入三四条，求 $C_n$ 。

$$
\begin{cases}
Q_{n+1} = Q_n + (2n+1) n^2 + C_n \\
-(n+1) Q_{n+1} = -(n-1) C_n - n^3(2n+1) - n^4 - (n - 1) Q_n \\
\end{cases}
$$

先化简一些，

$$
\begin{cases}
Q_{n+1} = Q_n + 2n^3+n^2 + C_n \\
-(n+1) Q_{n+1} = -(n-1) C_n - n^3 - 3 n^4 - (n - 1) Q_n \\
\end{cases}
$$

看第一条，

$$
Q_{n+1} = Q_n + 2n^3+n^2 + C_n
$$

同时乘 $(n-1)$ 。

$$
(n-1)Q_{n+1} = (n-1)Q_n + (2n^3+n^2)(n-1) + (n-1)C_n \\
= (n-1)Q_n + (n-1)C_n + 2n^4 - n^3 - n^2
$$

加上第二条，

$$
-2 Q_{n+1} = -n^4 - 2n^3 - n^2
$$

即，

$$
2Q_{n+1} = n^2(n +1) ^2
$$

现在就是求出来 $Q_n$ 了。

重写一下第一条，

$$
2(Q_{n+1} - Q_n) = 4n^3 + 2n^2 + 2C_n
$$

先算左边，

$$
2Q_{n+1} - 2Q_n \\
 = n^2(n+1)^2-(n-1)^2n^2 \\
 = 4n^3
$$

即，

$$
0=n^2+C_n
$$

综上，

$$
B_n = -(2n+1) \\
C_n = -n^2
$$

递推公式为，

$$
|n+1\rangle = x|n\rangle - (2n+1) |n\rangle - n^2 |n - 1\rangle
$$

现在求递推起点。

显然，

$$
|0\rangle = 1
$$

常数项显然满足方程，且满足首一条件。

然后，

$$
|1\rangle = x - t
$$

带入拉盖尔方程。这里代入原始形式即可，

$$
xD^2y+(1-x)Dy - \lambda y=0
$$

变为（本征值 $\lambda_1 = -1$ 已知，上文中已经求出），

$$
(1-x)+(x-t) = 0
$$

因此，

$$
|1\rangle = x - 1
$$

由此，得到，

递推关系，

$$
|n+1\rangle = x|n\rangle - (2n+1) |n\rangle - n^2 |n - 1\rangle
$$

与递推起点，

$$
|0\rangle = 1 \\
|1\rangle = x - 1
$$

我们还要算一下每个本征函数的模长，方便之后归一化。

因为，

$$
|n+1\rangle = x|n\rangle - (2n+1) |n\rangle - n^2 |n - 1\rangle
$$

$$
0 = \langle n - 1|x|n\rangle - n^2 \langle n - 1 |n - 1\rangle
$$

$\langle n - 1|x$ 可以展开，且 $\langle n|$ 项系数因为首一性必然为 $1$ ，因此，

$$
\langle n | n \rangle = n^2 \langle n - 1 |n - 1\rangle
$$

又，

$$
\langle 0|0\rangle = 1
$$

因此

$$
\langle n|n\rangle = (n!)^2
$$

因此首一本征函数的模长是 $n!$，如果要归一除以它就好。

## Rodrigues 公式

Rodrigues 公式是一整套公式，可以生成特殊函数。我们用生成函数推导。

对于拉盖尔函数，它满足（从 $n=1$ 开始）。

$$
L_{n+1} = (x-2n-1) L_n - n^2 L_{n-1}
$$

定义，

$$
G(z;x) = \sum_{n=0}^{\infty} \frac{1}{n!} L_n z^n
$$

递推公式两边乘 $\frac{z^n}{n!}$，

$$
\frac{z^{n}}{n!}L_{n+1} = \frac{z^n}{n!} (x-2n-1) L_n - \frac{z^n}{n!} n^2 L_{n-1}
$$

求从 $n=1$ 开始的和。

$$
\sum_{n=1}^{\infty} \frac{z^n}{n!}L_{n+1} = \sum_{n=1}^{\infty} \frac{z^n}{n!} (x-2n-1) L_n - \sum_{n=1}^{\infty} \frac{z^n}{n!} n^2 L_{n-1}
$$

拆一下，再约一下阶乘， $n^2=n(n-1)+n$ ，

$$
\sum_{n=1}^{\infty} \frac{z^n}{n!}L_{n+1} = \sum_{n=1}^{\infty} \frac{z^n}{n!} (x-1) L_n - 2\sum_{n=1}^{\infty} \frac{z^n}{(n-1)!} L_n - \sum_{n=1}^{\infty} \frac{z^n}{(n-2)!} L_{n-1} - \sum_{n=1}^{\infty} \frac{z^n}{(n-1)!} L_{n-1}
$$

左边考虑，

$$
G(z;x) - 1 = \sum_{n=1}^{\infty} \frac{1}{n!} L_n z^n
$$

$$
D(G(z;x) - 1) = \sum_{n=1}^{\infty} \frac{1}{(n-1)!} L_n z^{n-1} \\
= \sum_{n=0}^{\infty} \frac{1}{n!} L_{n+1} z^{n}
$$

$$
D(G(z;x) - 1) - (x-1) = \sum_{n=1}^{\infty} \frac{1}{n!} L_{n+1} z^{n}
$$

右边第一项，

$$
(x-1)(G(z;x) - 1) = \sum_{n=1}^{\infty} \frac{1}{n!} L_n (x-1) z^n
$$

右边第二项，

$$
zD(G(z;x) - 1) = \sum_{n=1}^{\infty} \frac{1}{(n-1)!} L_n z^{n}
$$

右边第三项，

$$
G(z;x) = \sum_{n=0}^{\infty} \frac{1}{n!} L_n z^n \\
= \sum_{n=1}^{\infty} \frac{1}{(n-1)!} L_{n-1} z^{n-1}
$$

$$
DG(z;x) = \sum_{n=1}^{\infty} \frac{1}{(n-2)!} L_{n-1} z^{n-2}
$$

$$
z^2DG(z;x) = \sum_{n=1}^{\infty} \frac{1}{(n-2)!} L_{n-1} z^{n}
$$

右边第四项，

$$
G(z;x) = \sum_{n=1}^{\infty} \frac{1}{(n-1)!} L_{n-1} z^{n-1}
$$

$$
zG(z;x) = \sum_{n=1}^{\infty} \frac{1}{(n-1)!} L_{n-1} z^{n}
$$

综上，

$$
D(G(z;x) - 1) - (x-1) = (x-1)(G(z;x) - 1) - 2 zD(G(z;x) - 1) - z^2DG(z;x) - zG(z;x)
$$

$D$ 作用再常数上是零，

$$
DG(z;x) - (x-1) = (x-1)(G(z;x) - 1) - 2 zDG(z;x) - z^2DG(z;x) - zG(z;x)
$$

继续整理，

$$
DG(z;x) = (x-1) G(z;x) - 2 zDG(z;x) - z^2DG(z;x) - zG(z;x)
$$

$$
(z+1)^2 DG(z;x) + (1+z-x) G(z;x) = 0
$$

$$
DG(z;x) + \frac{1+z-x}{(z+1)^2} G(z;x) = 0
$$

这是一阶方程，求积分因子，

$$
\int \frac{1+z-x}{(z+1)^2} \mathrm{d}z \\
= \int \frac{1}{z+1} \mathrm{d}z - \int \frac{x}{(z+1)^2} \mathrm{d}z \\
= \log(z+1) + \frac{x}{z+1} + ?
$$

因子为，

$$
e^{\log(z+1) + \frac{x}{z+1}} = (z+1) e^{\frac{x}{z+1}}
$$

因此方程的解是，

$$
(z+1) e^{\frac{x}{z+1}}G(z;x) = C
$$

$$
G(z;x) = C \frac{1}{z+1}e^{-\frac{x}{z+1}}
$$

现在确定 $C$ 。注意 $C$ 与 $z$ 无关，可以与 $x$ 有关 ，因为，

$$
G(z;x) = \sum_{n=0}^{\infty} \frac{1}{n!} L_n z^n
$$

$$
G(0;x) = L_0 = 1
$$

$$
G(0;x) = C e^{-x} = 1
$$

$$
C = e^x
$$

综上，

$$
G(z;x) = \frac{1}{z+1}e^{-\frac{x}{z+1} + x}
$$

有些书会用 $-z$ 代替 $z$ 。根据规定首一或是归一，常数也可能不同。

现在用留数定理（直接求导也可以，规律难找点），

$$
L_n(x) = \frac{n!}{2\pi i} \oint_{C(0)} \frac{G(z;x)}{z^{n+1}} dz
$$

现在没法积，做反演 $t = \frac{1}{z+1}$ ，

$$
dt = -t^2dz
$$

$$
L_n(x) = \frac{n!}{2\pi i} \oint_{C(1)} \frac{t^{n+2} e^{-xt+x}}{(1-t)^{n+1}} dz \\
= (-1)^n \frac{n!}{2\pi i} \oint_{C(1)} \frac{t^{n} e^{(1-t)x}}{(t-1)^{n+1}} dt \\
$$

有一个 $n+1$ 阶极点，用留数定理（下面的 $D$ 是对 $t$ 求导），

$$
L_n(x) = (-1)^n D^n(t^{n} e^{(1-t)x})|_{t=1}
$$

这个公式实际上已经完全可以用了，但这还不是 Rodrigues 公式。

$$
L_n(x) = (-1)^n D^n(t^{n} e^{(1-t)x})|_{t=1}
$$

做换元 $u=xt$ ，$t=\frac{u}{x}$，$\frac{\mathrm{d}}{\mathrm{d}t} = \frac{\mathrm{d}}{\mathrm{d}u} \frac{\mathrm{d}u}{\mathrm{d}t} = \frac{\mathrm{d}}{\mathrm{d}u} x$ ， 下面的 $D$ 是对 $u$ 求导。

$$
L_n(x) = (-1)^n e^x D^n(u^{n} e^{-u})|_{u=x}
$$

现在完全写开，

$$
L_n(x) = (-1)^n e^x \frac{\mathrm{d}^n}{(\mathrm{d}x)^n} (x^n e^{-x})
$$

这就是 Rodrigues 公式了。和课本上的公式差一个常数项和符号。这是因为我们用了首一规则。如果我们用交错的首一（即奇数阶首负一，偶数阶首一），可以消掉符号项。如果做归一化，会加一个除以阶乘项。

综上，我们自然地，完整地求解了拉盖尔方程。
